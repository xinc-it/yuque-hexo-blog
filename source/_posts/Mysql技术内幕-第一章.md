---
title: Mysql技术内幕-第一章
date: '2021/12/11 20:55:45'
updated: '2023-01-20 23:00:32'
categories: 数据库
tags:
  - Mysql
  - 数据库
  - InnoDB
---
![画板](/images/7fe28614f1d46c94e19b616349071499.jpeg)





# 1. 定义数据库和实例
### 
## 概念




1. 数据库**： **操作系统或者是内存中数据库类型文件的集合。



2. 实例： 数据库实例是真正操作数据库的对象。通过数据库实例完成对数据库文件的增删改查。





MySQL 是一个单进程多线程的数据库。MySQL数据库实例在系统上表现的就是一个进程。





# 2. MySQL 体系结构


## 1. 结构图
![](/images/9c9cc8552f1f4dfd93b0335914d5f7aa.png)

## 2. MySQL组成部分


### 1. 8大组成部分
1. 连接池
2. 管理服务和工具组件
3. Sql接口组件
4. 查询分析器
5. 优化器
6. 缓存
7. 插件式存储引擎
8. 物理文件





**<font style="background-color:#FADB14;">存储引擎是基于表的，而不是数据库。</font>**



**<font style="background-color:#FADB14;"></font>**

**<font style="background-color:#FADB14;"></font>**

**<font style="background-color:#FADB14;"></font>**

# 3. MySQL存储引擎


## 1. InnoDB 存储引擎(最常用的 5.5.8后默认存储引擎)


### 1. 特点
1. **行锁设计**
2. **支持外键**
3. **类似于Oracle 的非锁定读**





### 2. 主要功能
1. InnoDB 使用**多版本并发控制（MVCC）来实现高并发性。**
2. **实现了4种隔离级别**。默认的为REPEATABLE级别
3. 使用**next-key locking 策略来避免幻读现象**
4. 提供了插入缓冲（insert buffer）、二次写、自适应哈希索引、预读等高性能和高可用功能
5. 数据的存储的采用了**聚集的方式**，表的数据存储按主键的顺序存放。如果没有主键会默认每行生成一个ROWID作为主键。



### 3. 面向对象
设计目标主要面向**在线事务处理应用。**

****

****

## 2. MyISAM 存储引擎（5.58之前默认存储引擎）


### 1. 特点
1. **不支持事务、表锁/行锁**
2. **支持全文索引**
3. **缓冲池只缓存索引文件**，不缓存数据。
4. MyISAM 存储引擎表的由MYD和MYI两种文件存储。MYD存储数据，MYI存储索引。







## 3. NDB 存储引擎(集群存储引擎)




### 1. 特点
1. **数据全部放在内存中**，5.1后，可将非索引数据存放到磁盘上。
2. **主键查找速度极快**
3. 通过增加NDB数据存储节点，可以线性提高数据性能。是高可用、高性能集群系统
4. **查询速度慢**。由于NDB存储引擎连接操作在数据库层完成，导致需要巨大网络开销。



## 4. Memory 存储引擎


### 1. 特点
1. **数据存放在内存中**
2. **默认使用哈希索引**
3. **只支持表锁，并发性能差**
4. **不支持TEXT和BLOBl乐行**
5. **浪费内存，存储varchar是按照char的方式存储。**

****

## 5. 存储引擎的比较


![](/images/7de1a4f053f7f318287bb37c32a6a5d0.png)













# 4. 连接MySQL


本质： MySQL实例和连接进程的进行通信。

进程间的通信方式：TCP/IP套接字，UNIX域套接字、管道、命名管道。





### 1. TCP/IP（常用）


![](/images/d036459487d35f057141ec4a5b8ae7d7.png)

客户端通过向MySQL服务器发送TCP/IP连接请求，连接成功后。MySQL数据库会查权限视图，判断用户的客户端IP是否连接到MySQL实例。









# 5. 小结




1. 介绍了实例和数据库的区别。实例是操作数据库的对象，数据库是所有数据库类型文件的集合
2. MySQL的体系结构和其中的组件
    1. 连接池
    2. 管理服务和工具组件
    3. Sql接口
    4. 查询和分析器
    5. 优化器
    6. 缓存
    7. 插件式存储引擎
    8. 物理文件
3. MySQL主流的存储引擎及其特点
    1. InnoDB 支持行锁、事务\外键
    2. MyISAM 不支持行表锁、事务。支持全文索引
    3. Memory 支持哈希索引、表锁、不支持BLOB、TEXT类型。varchar定长.
    4. NDB数据存放在内存中







